

# Module apns_recs #
* [Description](#description)
* [Data Types](#types)
* [Function Index](#index)
* [Function Details](#functions)

`apns_recs` uses the `exprecs` parse transform to convert record
definitions to a set of functions that operate on the record in an opaque
manner.

Copyright (c) 2015-2016 Silent Circle

__Authors:__ Edwin Fine ([`efine@silentcircle.com`](mailto:efine@silentcircle.com)).

__References__* See
[`https://github.com/uwiger/parse_trans/blob/master/doc/exprecs.md`](https://github.com/uwiger/parse_trans/blob/master/doc/exprecs.md)
for more information.

<a name="description"></a>

## Description ##

This avoids compile-time dependencies on the records.

This module exports the following functions, generated by `exprecs`:

```
   '#exported_records-'/0
   '#fromlist-'/2
   '#fromlist-apns_error'/1
   '#fromlist-apns_error'/2
   '#fromlist-apns_notification'/1
   '#fromlist-apns_notification'/2
   '#get-'/2
   '#get-apns_error'/2
   '#get-apns_notification'/2
   '#info-'/1
   '#info-'/2
   '#info-apns_error'/1
   '#info-apns_notification'/1
   '#is_record-'/1
   '#is_record-'/2
   '#lens-'/2
   '#lens-apns_error'/1
   '#lens-apns_notification'/1
   '#new-'/1
   '#new-apns_error'/0
   '#new-apns_error'/1
   '#new-apns_notification'/0
   '#new-apns_notification'/1
   '#pos-'/2
   '#pos-apns_error'/1
   '#pos-apns_notification'/1
   '#set-'/2
   '#set-apns_error'/2
   '#set-apns_notification'/2
```


### <a name="Generic_Function_Operations">Generic Function Operations</a> ###



<dt><code>'#exported_records-'</code></dt>

 

<dd>Returns list of exported record names</dd>




<dt><code>'#new-'</code></dt>

 

<dd>Creates a new record</dd>




<dt><code>'#get'</code></dt>

 

<dd>Retrieves given attribute values from a record</dd>




<dt><code>'#set'</code></dt>

 

<dd>Sets given attribute values in a record</dd>




<dt><code>'#fromlist'</code></dt>

 

<dd>Creates a record from a key-value list</dd>




<dt><code>'#info'</code></dt>

 

<dd>Equivalent to record_info/2</dd>




<dt><code>'#pos'</code></dt>

 

<dd>Returns the position of a given attribute</dd>




<dt><code>'#is_record'</code></dt>

 

<dd>Tests if a value is a specific record</dd>




<dt><code>'#convert'</code></dt>

 

<dd>Converts an old record to the current version</dd>




<dt><code>'#prop'</code></dt>

 

<dd>Used only in type specs</dd>




<dt><code>'#attr'</code></dt>

 

<dd>Used only in type specs</dd>




<dt><code>'#lens'</code></dt>

 

<dd>Returns a 'lens' (an accessor pair) as described in
<a href="http://github.com/jlouis/erl-lenses" target="_top"><tt>http://github.com/jlouis/erl-lenses</tt></a></dd>




### <a name="Example_1:_Generic_Functions">Example 1: Generic Functions</a> ###

This is an example of the generic functions being used for the exported records.

```
   apns_recs:'#exported_records-'() ->
     [apns_notification,apns_error]
   apns_recs:'#fromlist-'([{cmd,atom_data},
                           {id,1},
                           {expire,1},
                           {token,<<"binary_data">>},
                           {payload,<<"binary_data">>},
                           {priority,1},
                           {rest,<<"binary_data">>}],
                           {apns_notification,simple,0,0,<<>>,<<>>,5,<<>>}) ->
     {apns_notification,atom_data,1,1,<<"binary_data">>,<<"binary_data">>,1,
                        <<"binary_data">>}
   apns_recs:'#get-'([cmd,id,expire,token,payload,priority,rest],
                     {apns_notification,simple,0,0,<<>>,<<>>,5,<<>>}) ->
     [simple,0,0,<<>>,<<>>,5,<<>>]
   apns_recs:'#info-'(apns_notification) ->
     [cmd,id,expire,token,payload,priority,rest]
   apns_recs:'#info-'(apns_notification, fields) ->
     [cmd,id,expire,token,payload,priority,rest]
   apns_recs:'#info-'(apns_notification, size) ->
     8
   apns_recs:'#is_record-'({apns_notification,simple,0,0,<<>>,<<>>,5,<<>>}) ->
     true
   apns_recs:'#is_record-'(apns_notification,
                           {apns_notification,simple,0,0,<<>>,<<>>,5,<<>>}) ->
     true
   apns_recs:'#lens-'(cmd, apns_notification) ->
     {#Fun<apns_recs.8.63329237>,#Fun<apns_recs.9.63329237>}
   apns_recs:'#new-'(apns_notification) ->
     {apns_notification,simple,0,0,<<>>,<<>>,5,<<>>}
   apns_recs:'#pos-'(apns_notification, cmd) ->
     2
   apns_recs:'#set-'([{cmd,atom_data},
                      {id,1},
                      {expire,1},
                      {token,<<"binary_data">>},
                      {payload,<<"binary_data">>},
                      {priority,1},
                      {rest,<<"binary_data">>}],
                      {apns_notification,simple,0,0,<<>>,<<>>,5,<<>>}) ->
     {apns_notification,atom_data,1,1,<<"binary_data">>,<<"binary_data">>,1,
                        <<"binary_data">>}
   apns_recs:'#fromlist-'([{id,1},{status,atom_data},{status_code,1},{status_desc,<<"binary_data">>}], {apns_error,0,undefined,0,<<>>}) ->
     {apns_error,1,atom_data,1,<<"binary_data">>}
   apns_recs:'#get-'([id,status,status_code,status_desc], {apns_error,0,undefined,0,<<>>}) ->
     [0,undefined,0,<<>>]
   apns_recs:'#info-'(apns_error) ->
     [id,status,status_code,status_desc]
   apns_recs:'#info-'(apns_error, fields) ->
     [id,status,status_code,status_desc]
   apns_recs:'#info-'(apns_error, size) ->
     5
   apns_recs:'#is_record-'({apns_error,0,undefined,0,<<>>}) ->
     true
   apns_recs:'#is_record-'(apns_error, {apns_error,0,undefined,0,<<>>}) ->
     true
   apns_recs:'#lens-'(id, apns_error) ->
     {#Fun<apns_recs.20.63329237>,#Fun<apns_recs.21.63329237>}
   apns_recs:'#new-'(apns_error) ->
     {apns_error,0,undefined,0,<<>>}
   apns_recs:'#pos-'(apns_error, id) ->
     2
   apns_recs:'#set-'([{id,1},{status,atom_data},{status_code,1},{status_desc,<<"binary_data">>}], {apns_error,0,undefined,0,<<>>}) ->
     {apns_error,1,atom_data,1,<<"binary_data">>}
   apns_recs:'#exported_records-'() ->
     [apns_notification,apns_error]
```


<a name="types"></a>

## Data Types ##




### <a name="type-apns_error">apns_error()</a> ###


<pre><code>
apns_error() = #apns_error{id = integer(), status = atom(), status_code = integer(), status_desc = binary()}
</code></pre>




### <a name="type-apns_notification">apns_notification()</a> ###


<pre><code>
apns_notification() = #apns_notification{cmd = <a href="#type-cmd_type">cmd_type()</a>, id = integer(), expire = integer(), token = binary(), payload = binary(), priority = non_neg_integer(), rest = binary()}
</code></pre>




### <a name="type-cmd_type">cmd_type()</a> ###


<pre><code>
cmd_type() = simple | enhanced | v2
</code></pre>




### <a name="type-func_name">func_name()</a> ###


<pre><code>
func_name() = atom()
</code></pre>




### <a name="type-func_spec">func_spec()</a> ###


<pre><code>
func_spec() = atom()
</code></pre>




### <a name="type-help_name">help_name()</a> ###


<pre><code>
help_name() = <a href="#type-func_name">func_name()</a> | <a href="#type-rec_name">rec_name()</a>
</code></pre>




### <a name="type-help_result">help_result()</a> ###


<pre><code>
help_result() = ok | undefined | [<a href="#type-rec_name">rec_name()</a>]
</code></pre>




### <a name="type-rec_name">rec_name()</a> ###


<pre><code>
rec_name() = atom()
</code></pre>

<a name="index"></a>

## Function Index ##


<table width="100%" border="1" cellspacing="0" cellpadding="2" summary="function index"><tr><td valign="top"><a href="#help-0">help/0</a></td><td>Show help for help().</td></tr><tr><td valign="top"><a href="#help-1">help/1</a></td><td>Show help for exported records and functions.</td></tr><tr><td valign="top"><a href="#help-2">help/2</a></td><td>Return a list of function specs for the given <code>Recname</code>.</td></tr></table>


<a name="functions"></a>

## Function Details ##

<a name="help-0"></a>

### help/0 ###

<pre><code>
help() -&gt; ok
</code></pre>
<br />

Show help for help(). This is intended for debugging and
documentation.

<a name="help-1"></a>

### help/1 ###

<pre><code>
help(Item) -&gt; Result
</code></pre>

<ul class="definitions"><li><code>Item = all | generic | records | <a href="#type-help_name">help_name()</a></code></li><li><code>Result = <a href="#type-help_result">help_result()</a></code></li></ul>

Show help for exported records and functions.
This is intended for debugging and documentation.

<a name="help-2"></a>

### help/2 ###

<pre><code>
help(Recname, X2::funcs) -&gt; Result
</code></pre>

<ul class="definitions"><li><code>Recname = <a href="#type-rec_name">rec_name()</a></code></li><li><code>Result = [<a href="#type-func_spec">func_spec()</a>] | undefined</code></li></ul>

Return a list of function specs for the given `Recname`.
A function spec is the usual func/arity as an atom, e.g.
`'#new-apns_error/0'`.
This is intended for debugging and documentation.

